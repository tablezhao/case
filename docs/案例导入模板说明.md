# 案例导入模板说明

## 📋 概述

本文档说明如何准备Excel文件以导入案例数据到合规通平台。

---

## 📊 Excel模板格式

### 必需列（带 ⭐ 标记）

| 列名 | 说明 | 示例 | 是否必需 |
|------|------|------|---------|
| ⭐ 通报日期 | 案例通报的日期 | 2024-01-15 | 是 |
| ⭐ 应用名称 | 被通报的应用名称 | 微信 | 是 |
| 开发者/运营者 | 应用的开发者或运营者 | 腾讯科技 | 否 |
| 监管部门 | 发出通报的监管部门 | 工业和信息化部 | 否 |
| 应用平台 | 应用所在平台 | 微信小程序 | 否 |
| 主要违规内容 | 违规内容描述 | 未经用户同意收集个人信息 | 否 |
| 原文链接 | 官方通报原文链接 | https://www.miit.gov.cn/... | 否 |

### 可选列名（兼容性）

- **违规摘要**：如果没有"主要违规内容"列，可以使用"违规摘要"列

---

## 📅 日期格式支持

系统支持多种日期格式，会自动识别和转换：

### 支持的格式

1. **ISO格式**（推荐）
   - `2024-01-15`
   - `2024/01/15`

2. **中文格式**
   - `2024年1月15日`
   - `2024年01月15日`

3. **Excel序列号**
   - Excel内部的日期数字（如 `44927`）
   - 系统会自动识别并转换

4. **其他格式**
   - `01/15/2024`（美式）
   - `15/01/2024`（欧式）

### 日期格式建议

✅ **推荐使用**：`YYYY-MM-DD` 格式（如 `2024-01-15`）

❌ **避免使用**：
- 纯文本描述（如"2024年1月"）
- 不完整的日期（如"1月15日"）
- 模糊的日期（如"上个月"）

---

## 📝 Excel模板示例

### 示例1：完整数据

| 通报日期 | 应用名称 | 开发者/运营者 | 监管部门 | 应用平台 | 主要违规内容 | 原文链接 |
|---------|---------|--------------|---------|---------|-------------|---------|
| 2024-01-15 | 微信 | 腾讯科技 | 工业和信息化部 | 微信小程序 | 未经用户同意收集个人信息 | https://www.miit.gov.cn/... |
| 2024-01-16 | 抖音 | 字节跳动 | 国家网信办 | 抖音平台 | 违规推送信息 | https://www.cac.gov.cn/... |

### 示例2：最简数据（仅必需字段）

| 通报日期 | 应用名称 |
|---------|---------|
| 2024-01-15 | 微信 |
| 2024-01-16 | 抖音 |

---

## 🚀 导入步骤

### 1. 准备Excel文件

1. 打开Excel或WPS
2. 创建新工作表
3. 在第一行输入列名（必须与模板完全一致）
4. 从第二行开始输入数据

### 2. 数据验证

在导入前，请检查：

- [x] 第一行是否为列名（不是数据）
- [x] "通报日期"列是否有值
- [x] "应用名称"列是否有值
- [x] 日期格式是否正确
- [x] 没有完全空白的行

### 3. 执行导入

1. 登录后台管理系统
2. 进入"案例管理"页面
3. 点击"导入"按钮
4. 选择准备好的Excel文件
5. 等待导入完成

### 4. 查看结果

导入完成后，系统会显示：

- ✅ 成功导入的案例数量
- 🔄 去重的案例数量
- 🏢 新增的监管部门
- 📱 新增的应用平台
- ⚠️ 跳过的数据（如果有）

---

## ⚠️ 常见错误及解决方法

### 错误1：通报日期格式错误或为空

**错误信息**：
```
第2行：通报日期格式错误或为空
```

**原因**：
- 日期列为空
- 日期格式无法识别
- 单元格格式不正确

**解决方法**：
1. 确保日期列有值
2. 使用推荐的日期格式：`YYYY-MM-DD`
3. 在Excel中将单元格格式设置为"日期"或"文本"

### 错误2：应用名称不能为空

**错误信息**：
```
第3行：应用名称不能为空
```

**原因**：
- 应用名称列为空
- 单元格只包含空格

**解决方法**：
1. 填写应用名称
2. 删除该行（如果不需要）

### 错误3：Excel文件中没有数据

**错误信息**：
```
Excel文件中没有数据
```

**原因**：
- 工作表为空
- 只有表头没有数据行
- 选择了错误的工作表

**解决方法**：
1. 确保至少有一行数据（除了表头）
2. 检查是否在正确的工作表中
3. 确保数据从第二行开始

### 错误4：创建部门失败

**错误信息**：
```
创建部门失败: XXX部门
```

**原因**：
- 部门名称重复
- 部门名称包含特殊字符
- 数据库连接问题

**解决方法**：
1. 检查部门名称是否已存在
2. 移除特殊字符
3. 联系技术支持

---

## 💡 最佳实践

### 1. 数据准备

- ✅ 使用统一的日期格式
- ✅ 保持部门名称一致（避免"工信部"和"工业和信息化部"混用）
- ✅ 保持平台名称一致
- ✅ 删除空白行
- ✅ 删除测试数据

### 2. 批量导入

- ✅ 建议每次导入不超过1000条
- ✅ 大量数据分批导入
- ✅ 导入前备份现有数据

### 3. 数据质量

- ✅ 确保数据准确性
- ✅ 填写完整的违规内容
- ✅ 提供原文链接
- ✅ 核对日期是否正确

### 4. 去重机制

系统会自动去重，判断标准：
- 通报日期相同
- 应用名称相同
- 开发者相同
- 监管部门相同
- 应用平台相同
- 违规内容相同
- 原文链接相同

如果所有字段都相同，系统会保留最新导入的数据。

---

## 🔧 高级功能

### 智能创建

导入时，系统会自动：

1. **创建新部门**
   - 如果监管部门不存在，自动创建
   - 默认级别：国家级

2. **创建新平台**
   - 如果应用平台不存在，自动创建

3. **去重处理**
   - 自动识别重复数据
   - 保留最新导入的版本

### 导出功能

导入后，可以导出数据：

1. 点击"导出"按钮
2. 选择导出格式（Excel）
3. 下载文件

导出的文件可以直接用于再次导入。

---

## 📞 技术支持

### 遇到问题？

1. **查看错误信息**
   - 系统会显示详细的错误信息
   - 记录错误信息以便排查

2. **检查数据格式**
   - 对照本文档检查Excel格式
   - 确保必需字段有值

3. **联系技术支持**
   - 提供错误信息
   - 提供Excel文件样本
   - 说明导入步骤

---

## 📚 相关文档

1. **案例管理用户手册** - 案例管理功能详细说明
2. **后台管理系统指南** - 后台系统使用指南
3. **数据导入导出规范** - 数据格式规范

---

## 📋 快速检查清单

导入前请确认：

- [ ] Excel文件格式正确
- [ ] 第一行是列名
- [ ] "通报日期"和"应用名称"列有值
- [ ] 日期格式正确
- [ ] 没有空白行
- [ ] 数据已验证
- [ ] 已备份现有数据（如果需要）

---

**文档版本**：v1.0  
**最后更新**：2025-12-08  
**适用版本**：合规通 v1.0+
