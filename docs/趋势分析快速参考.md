# 趋势分析功能 - 快速参考

## 🚀 核心功能

### 时间维度筛选
- 📅 **月度**：选择具体年月（如2025年01月）
- 📆 **半年度**：选择上半年（1-6月）或下半年（7-12月）
- 📊 **年度**：选择整年（如2025年）
- 🌐 **全部时间段**：不限时间范围

### 双排行榜展示
- 📈 **通报频次排行榜**：按部门通报次数排序
- 🏆 **通报应用量排行榜**：按部门通报应用总数排序
- 🥇🥈🥉 前三名特殊样式高亮

---

## 📊 数据指标

### 通报频次
- **定义**：同一部门不同日期的通报次数
- **计算**：唯一日期数（去重）
- **示例**：某部门在1月1日、1月5日、1月10日各通报一次，通报频次=3

### 通报应用量
- **定义**：部门通报的应用总数
- **计算**：所有案例的application_count字段累加
- **示例**：某部门3次通报分别涉及10、15、20个应用，通报应用量=45

---

## 🎯 使用场景

### 场景1：查看本月监管情况
1. 选择"月度"维度
2. 选择当前年份和月份
3. 查看两个排行榜

### 场景2：对比上下半年
1. 选择"半年度"维度
2. 先选择"上半年"查看数据
3. 再选择"下半年"对比

### 场景3：年度总结
1. 选择"年度"维度
2. 选择目标年份
3. 查看全年排名

### 场景4：历史总览
1. 选择"全部时间段"维度
2. 查看所有时间的累计排名

---

## 🔧 API使用

### 函数签名
```typescript
getDepartmentRanking(params: {
  dimension: 'monthly' | 'half-yearly' | 'yearly' | 'all';
  year?: string;
  month?: string;
  halfYear?: 'H1' | 'H2';
  limit?: number;
})
```

### 调用示例

**月度查询**：
```typescript
getDepartmentRanking({
  dimension: 'monthly',
  year: '2025',
  month: '01',
  limit: 10
})
```

**半年度查询**：
```typescript
getDepartmentRanking({
  dimension: 'half-yearly',
  year: '2025',
  halfYear: 'H1',
  limit: 10
})
```

**年度查询**：
```typescript
getDepartmentRanking({
  dimension: 'yearly',
  year: '2025',
  limit: 10
})
```

**全部时间段**：
```typescript
getDepartmentRanking({
  dimension: 'all',
  limit: 10
})
```

---

## 📁 关键文件

### API层
```
src/db/api.ts
└── getDepartmentRanking() - 第1902-2009行
```

### 页面组件
```
src/pages/TrendAnalysisPage.tsx
└── 完整的趋势分析页面（340行）
```

---

## 🎨 UI特性

### 排名徽章
- 🥇 第1名：金色徽章
- 🥈 第2名：银色徽章
- 🥉 第3名：铜色徽章
- 其他：轮廓徽章

### 前三名样式
- 渐变背景
- 主题色边框
- 特殊徽章

### 指标高亮
- 通报频次排行榜：通报频次数字高亮
- 通报应用量排行榜：通报应用量数字高亮

---

## ⚡ 性能指标

| 指标 | 目标值 |
|------|--------|
| 首次加载 | < 2秒 |
| 切换维度 | < 1秒 |
| 交互响应 | < 100ms |

---

## 📱 响应式支持

- ✅ 桌面端：双排行榜并列
- ✅ 平板端：双排行榜并列（稍窄）
- ✅ 移动端：排行榜垂直堆叠

---

## 🔍 快速排查

### 问题：数据不显示
1. 检查网络连接
2. 检查选择的时间段是否有数据
3. 查看浏览器控制台错误信息

### 问题：加载很慢
1. 检查网络速度
2. 检查数据库连接
3. 尝试切换到更小的时间范围

### 问题：排名不对
1. 确认查看的是哪个排行榜
2. 左侧按通报频次排序
3. 右侧按通报应用量排序

---

## 📖 详细文档

完整说明请参考：[趋势分析功能重构说明.md](./趋势分析功能重构说明.md)

---

**更新时间**：2025-12-09  
**版本**：v1.0  
**状态**：✅ 已完成
