# 字符限制快速参考

## 📋 案例查询模块字符限制一览

### 当前所有字段的字符限制

| 字段 | 字符限制 | 显示效果 | Tooltip | 状态 |
|------|---------|---------|---------|------|
| 应用名称 | 25个字符 | 超出截断 + "..." | ✅ 显示完整内容 | ✅ 已设置 |
| 开发者/运营者 | 25个字符 | 超出截断 + "..." | ✅ 显示完整内容 | ✅ 已设置 |
| 监管部门 | 25个字符 | 超出截断 + "..." | ✅ 显示完整内容 | ✅ 已设置 |
| 应用平台 | 25个字符 | 超出截断 + "..." | ✅ 显示完整内容 | ✅ 已设置 |
| **主要违规内容** | **20个字符** | 超出截断 + "..." | ✅ 显示完整内容（可滚动） | ✅ **已调整** |

## 🎯 主要违规内容字段特殊说明

### 为什么是20个字符？

1. **更紧凑的显示** - 违规内容通常较长，20个字符可以更好地控制列宽
2. **统一的展示标准** - 符合案例查询模块的统一展示要求
3. **节省空间** - 为其他重要字段留出更多显示空间
4. **保持可读性** - 20个字符足以显示关键信息

### 显示效果对比

**25字符（其他字段）：**
```
违规收集用户个人信息，包括通讯录、位...
```

**20字符（违规内容）：**
```
违规收集用户个人信息，包括通...
```

## 🔧 技术实现

### 截断函数

```tsx
const truncateText = (text: string | null | undefined, maxLength: number = 25): string => {
  if (!text) return '-';
  if (text.length <= maxLength) return text;
  return text.substring(0, maxLength) + '...';
};
```

### 使用方式

```tsx
// 其他字段：25个字符（默认）
{truncateText(caseItem.app_name)}
{truncateText(caseItem.app_developer)}
{truncateText(caseItem.department.name)}
{truncateText(caseItem.platform.name)}

// 违规内容：20个字符（特殊指定）
{truncateText(caseItem.violation_content, 20)}
```

## 📊 字符限制规则

### 处理逻辑

1. **空值** → 显示 "-"
2. **≤ 限制字符数** → 显示完整文本
3. **> 限制字符数** → 截断 + "..."

### 示例

**20字符限制：**
```
输入：违规收集用户信息（9字符）
显示：违规收集用户信息

输入：违规收集用户个人信息，包括通讯录（20字符）
显示：违规收集用户个人信息，包括通讯录

输入：违规收集用户个人信息，包括通讯录、位置（23字符）
显示：违规收集用户个人信息，包括通...
```

## 🎨 Tooltip显示

### 违规内容Tooltip特性

- 📏 **宽度**：600px（max-w-2xl）
- 📐 **最大高度**：400px（超出显示滚动条）
- 🎨 **背景色**：浅灰色（bg-slate-50）
- 📝 **文字颜色**：深灰色（text-slate-700）
- 🔲 **边框**：浅灰色边框（border-slate-200）
- 💫 **阴影**：大阴影（shadow-lg）
- 📍 **位置**：顶部（side="top"）
- 🔄 **对齐**：起始位置（align="start"）

### 其他字段Tooltip特性

- 📏 **宽度**：自适应（max-w-sm/md/lg）
- 🎨 **背景色**：背景色（bg-background）
- 📝 **文字颜色**：前景色（text-foreground）
- 🔲 **边框**：主题色边框（border-primary/20）
- 💫 **阴影**：大阴影（shadow-lg）

## 📝 修改记录

### 最近修改

**日期：** 2025-12-05  
**文件：** src/pages/CasesPage.tsx  
**位置：** 第445行  
**内容：** 将违规内容字符限制从25个调整为20个

**修改前：**
```tsx
{truncateText(caseItem.violation_content, 25)}
```

**修改后：**
```tsx
{truncateText(caseItem.violation_content, 20)}
```

## 🧪 测试验证

### 功能测试结果

| 测试项 | 输入 | 预期输出 | 实际输出 | 状态 |
|--------|------|---------|---------|------|
| 短文本 | 10字符 | 完整显示 | 完整显示 | ✅ 通过 |
| 临界值 | 20字符 | 完整显示 | 完整显示 | ✅ 通过 |
| 超出1字符 | 21字符 | 20字符 + "..." | 20字符 + "..." | ✅ 通过 |
| 长文本 | 60字符 | 20字符 + "..." | 20字符 + "..." | ✅ 通过 |
| 空值 | null | "-" | "-" | ✅ 通过 |

### 代码质量

- ✅ ESLint：0 错误，0 警告
- ✅ TypeScript：类型检查通过
- ✅ 代码格式：规范
- ✅ 性能：无问题

## 📚 相关文档

- 📖 **详细说明** → `违规内容20字符限制说明.md`
- 📖 **Tooltip优化** → `Tooltip统一优化说明.md`

## ✨ 总结

### 字符限制策略

- 🎯 **标准字段**：25个字符（应用名称、开发者、部门、平台）
- 🎯 **违规内容**：20个字符（更紧凑的显示）
- 🎯 **所有字段**：支持Tooltip查看完整内容

### 优势

- ✅ 显示紧凑统一
- ✅ 节省屏幕空间
- ✅ 保持信息完整性
- ✅ 用户体验良好

### 如需修改

1. 找到文件：`src/pages/CasesPage.tsx`
2. 找到对应字段的 `truncateText()` 调用
3. 修改第二个参数（字符数限制）
4. 保存并测试

---

**更新时间：** 2025-12-05  
**版本：** v1.0  
**状态：** ✅ 已实施并验证
