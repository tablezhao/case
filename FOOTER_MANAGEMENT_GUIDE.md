# 页脚后台管理系统 - 使用指南

## 功能概述

页脚后台管理系统允许管理员通过可视化界面动态配置网站页脚的各个模块内容，所有修改将实时同步到前台展示。

## 核心功能

### ✅ 已实现功能

1. **模块化管理**
   - 8个独立的页脚模块
   - 每个模块可单独配置
   - 支持启用/禁用控制

2. **内容编辑**
   - JSON格式内容编辑
   - 实时内容预览
   - 格式验证提示

3. **显示控制**
   - 模块显示顺序调整
   - 模块启用/禁用开关
   - 前台实时同步

4. **数据持久化**
   - 数据库存储配置
   - 自动更新时间戳
   - 数据安全保护

## 系统架构

### 数据库设计

**表名**：`footer_settings`

**字段说明**：
```sql
- id (uuid)              - 主键
- section (text)         - 模块标识（唯一）
- title (text)           - 模块标题
- content (jsonb)        - 模块内容（JSON格式）
- display_order (int)    - 显示顺序
- is_active (boolean)    - 是否启用
- created_at (timestamp) - 创建时间
- updated_at (timestamp) - 更新时间
```

**安全策略**：
- 所有用户可读取启用的配置（前台展示）
- 仅管理员可以修改配置（后台管理）

### 模块类型

系统预设了8个页脚模块：

| 模块标识 | 模块名称 | 说明 |
|---------|---------|------|
| `about` | 关于我们 | 平台简介和联系邮箱 |
| `navigation` | 快速导航 | 站内链接列表 |
| `friendly_links` | 友情链接 | 外部网站链接列表 |
| `social_media` | 社交媒体 | 社交平台图标和链接 |
| `newsletter` | 订阅资讯 | Newsletter订阅功能 |
| `copyright` | 版权信息 | 版权声明和年份 |
| `filing` | 备案信息 | ICP和公安备案号 |
| `disclaimer` | 免责声明 | 法律责任声明 |

## 使用指南

### 访问后台管理

1. **登录系统**
   - 访问：`/login`
   - 使用管理员账号登录

2. **进入页脚配置**
   - 访问：`/admin/footer-settings`
   - 或从管理后台首页点击"页脚配置"卡片

### 编辑模块内容

#### 步骤1：选择模块

点击要编辑的模块，展开编辑面板。

#### 步骤2：修改内容

**修改标题**：
```
在"模块标题"输入框中修改标题文字
```

**修改显示顺序**：
```
在"显示顺序"输入框中输入数字
数字越小，模块在页脚中的位置越靠前
```

**修改内容**：
```
在"模块内容"文本框中编辑JSON格式的内容
系统会自动验证JSON格式
```

#### 步骤3：保存修改

点击"保存修改"按钮，系统会：
1. 验证JSON格式
2. 保存到数据库
3. 显示成功提示
4. 前台立即生效

### 启用/禁用模块

使用"模块状态"开关可以控制模块在前台的显示：
- **开启**：模块在前台显示
- **关闭**：模块在前台隐藏

### 查看内容格式说明

点击"查看示例"按钮，可以查看每个模块的内容格式说明和示例。

## 内容格式详解

### 1. 关于我们（about）

**格式**：
```json
{
  "description": "平台简介文字，建议80字以内",
  "email": "contact@example.com"
}
```

**字段说明**：
- `description`：平台简介，显示在页脚左侧
- `email`：联系邮箱，点击可发送邮件

**示例**：
```json
{
  "description": "合规通致力于打造信息透明、查询便捷的App监管案例平台，汇集各级网络监管部门发布的违规案例和监管资讯，助力企业合规发展，保护用户权益。",
  "email": "contact@compliance.gov.cn"
}
```

### 2. 快速导航（navigation）

**格式**：
```json
{
  "links": [
    {"name": "链接名称", "path": "/路径"}
  ]
}
```

**字段说明**：
- `links`：链接数组
- `name`：链接显示文字
- `path`：站内路径（使用React Router）

**示例**：
```json
{
  "links": [
    {"name": "首页", "path": "/"},
    {"name": "案例查询", "path": "/cases"},
    {"name": "监管资讯", "path": "/news"},
    {"name": "管理后台", "path": "/login"}
  ]
}
```

### 3. 友情链接（friendly_links）

**格式**：
```json
{
  "links": [
    {"name": "网站名称", "url": "https://example.com"}
  ]
}
```

**字段说明**：
- `links`：链接数组
- `name`：网站名称
- `url`：完整的外部链接（包含https://）

**示例**：
```json
{
  "links": [
    {"name": "工业和信息化部", "url": "https://www.miit.gov.cn"},
    {"name": "国家互联网信息办公室", "url": "https://www.cac.gov.cn"},
    {"name": "公安部", "url": "https://www.mps.gov.cn"},
    {"name": "市场监管总局", "url": "https://www.samr.gov.cn"}
  ]
}
```

### 4. 社交媒体（social_media）

**格式**：
```json
{
  "platforms": [
    {"name": "平台名称", "icon": "图标文字", "qrcode": true},
    {"name": "平台名称", "icon": "图标文字", "url": "#"}
  ]
}
```

**字段说明**：
- `platforms`：平台数组
- `name`：平台名称（用于tooltip）
- `icon`：图标显示文字（1-2个字）
- `qrcode`：是否显示二维码（可选）
- `url`：链接地址（可选）

**示例**：
```json
{
  "platforms": [
    {"name": "微信公众号", "icon": "微信", "qrcode": true},
    {"name": "官方微博", "icon": "微博", "url": "#"}
  ]
}
```

### 5. 订阅资讯（newsletter）

**格式**：
```json
{
  "description": "订阅说明文字",
  "privacy_note": "隐私声明文字",
  "enabled": true
}
```

**字段说明**：
- `description`：订阅功能说明
- `privacy_note`：隐私保护声明
- `enabled`：是否启用订阅功能

**示例**：
```json
{
  "description": "订阅我们的邮件列表，获取最新监管动态和案例分析",
  "privacy_note": "我们尊重您的隐私，不会向第三方分享您的信息",
  "enabled": true
}
```

### 6. 版权信息（copyright）

**格式**：
```json
{
  "company_name": "公司名称",
  "show_year": true
}
```

**字段说明**：
- `company_name`：公司或组织名称
- `show_year`：是否显示年份（自动更新）

**示例**：
```json
{
  "company_name": "合规通",
  "show_year": true
}
```

**前台显示**：`© 2025 合规通`

### 7. 备案信息（filing）

**格式**：
```json
{
  "icp": {
    "number": "备案号",
    "url": "查询链接"
  },
  "police": {
    "number": "公安备案号",
    "url": "查询链接"
  }
}
```

**字段说明**：
- `icp`：ICP备案信息
- `police`：公安备案信息
- `number`：备案号
- `url`：备案查询链接

**示例**：
```json
{
  "icp": {
    "number": "京ICP备XXXXXXXX号",
    "url": "https://beian.miit.gov.cn"
  },
  "police": {
    "number": "京公网安备XXXXXXXXXXXXX号",
    "url": "http://www.beian.gov.cn"
  }
}
```

### 8. 免责声明（disclaimer）

**格式**：
```json
{
  "text": "免责声明的完整文字内容"
}
```

**字段说明**：
- `text`：免责声明文字，建议200字以内

**示例**：
```json
{
  "text": "本平台所展示的监管案例和资讯均来源于各级监管部门官方网站，仅供参考学习使用。如有疑问或需要了解详细信息，请访问相关监管部门官方网站或联系相关部门。本平台不对信息的准确性、完整性、及时性承担任何法律责任。"
}
```

## 前台展示逻辑

### 数据加载

前台Footer组件会：
1. 在组件加载时从数据库读取配置
2. 仅读取`is_active = true`的模块
3. 按`display_order`排序显示

### 实时同步

当管理员在后台修改配置后：
1. 数据立即保存到数据库
2. 用户刷新页面后看到最新内容
3. 无需重新部署或重启服务

### 响应式适配

页脚在不同设备上的显示：
- **桌面端**：4列网格布局
- **平板端**：2列网格布局
- **移动端**：单列堆叠布局

## 常见操作

### 修改联系邮箱

1. 展开"关于我们"模块
2. 修改content中的`email`字段
3. 保存修改

### 添加友情链接

1. 展开"友情链接"模块
2. 在`links`数组中添加新对象
3. 格式：`{"name": "网站名称", "url": "https://..."}`
4. 保存修改

### 修改版权信息

1. 展开"版权信息"模块
2. 修改`company_name`字段
3. 设置`show_year`为`true`或`false`
4. 保存修改

### 隐藏某个模块

1. 展开要隐藏的模块
2. 关闭"模块状态"开关
3. 该模块立即在前台隐藏

### 调整模块顺序

1. 展开要调整的模块
2. 修改"显示顺序"数字
3. 数字越小越靠前
4. 保存修改

## 注意事项

### JSON格式要求

1. **必须是有效的JSON**
   - 使用双引号，不能使用单引号
   - 对象和数组格式正确
   - 不能有多余的逗号

2. **字段名称不能修改**
   - 保持预设的字段名称
   - 只修改字段值

3. **数组格式**
   - 多个项目用逗号分隔
   - 最后一项后面不加逗号

### 内容建议

1. **文字长度**
   - 简介：80字以内
   - 免责声明：200字以内
   - 链接名称：10字以内

2. **链接有效性**
   - 定期检查外部链接
   - 确保URL完整正确
   - 使用https协议

3. **备案信息**
   - 使用真实的备案号
   - 链接指向正确的查询页面

## 故障排查

### 保存失败

**问题**：点击保存后显示错误

**原因**：
1. JSON格式错误
2. 网络连接问题
3. 权限不足

**解决方法**：
1. 检查JSON格式是否正确
2. 使用在线JSON验证工具
3. 确认管理员权限
4. 刷新页面重试

### 前台不显示

**问题**：修改后前台没有变化

**原因**：
1. 模块被禁用
2. 浏览器缓存
3. 内容格式错误

**解决方法**：
1. 检查模块是否启用
2. 清除浏览器缓存
3. 检查content格式
4. 查看浏览器控制台错误

### JSON格式错误

**问题**：提示"JSON格式错误"

**常见错误**：
```json
// ❌ 错误：使用单引号
{'name': 'value'}

// ✅ 正确：使用双引号
{"name": "value"}

// ❌ 错误：多余的逗号
{"name": "value",}

// ✅ 正确：无多余逗号
{"name": "value"}

// ❌ 错误：缺少引号
{name: "value"}

// ✅ 正确：键名加引号
{"name": "value"}
```

## 最佳实践

### 1. 定期备份

虽然数据存储在数据库中，但建议：
- 定期导出配置
- 保存重要版本
- 记录修改历史

### 2. 测试修改

在保存前：
- 检查JSON格式
- 预览内容效果
- 确认链接有效

### 3. 渐进式修改

建议：
- 一次修改一个模块
- 保存后检查前台效果
- 确认无误后继续

### 4. 文档记录

建议记录：
- 修改时间
- 修改内容
- 修改原因
- 修改人员

## 技术细节

### API接口

**获取所有配置**：
```typescript
getFooterSettings() // 仅返回启用的配置
getAllFooterSettings() // 返回所有配置（管理员）
```

**更新配置**：
```typescript
updateFooterSetting(id, {
  title: '新标题',
  content: {...},
  display_order: 1,
  is_active: true
})
```

### 数据流

```
后台编辑 → 保存到数据库 → 前台读取 → 渲染展示
    ↓
  验证JSON
    ↓
  更新时间戳
```

### 权限控制

- **前台读取**：所有用户（仅启用的配置）
- **后台查看**：管理员
- **后台编辑**：管理员
- **后台删除**：管理员

## 未来扩展

### 计划功能

1. **可视化编辑器**
   - 表单式编辑界面
   - 无需编写JSON
   - 实时预览效果

2. **版本管理**
   - 配置版本历史
   - 一键回滚
   - 对比差异

3. **模板系统**
   - 预设配置模板
   - 一键应用
   - 自定义模板

4. **批量操作**
   - 批量启用/禁用
   - 批量导入/导出
   - 批量排序

## 支持与反馈

如有问题或建议，请：
1. 查看本文档
2. 联系系统管理员
3. 提交反馈意见

---

**文档版本**：v1.0  
**最后更新**：2025-01-15  
**适用版本**：合规通 v2.0+  
**维护团队**：合规通开发团队
